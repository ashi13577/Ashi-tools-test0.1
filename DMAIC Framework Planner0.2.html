<!DOCTYPE html>
<html>
<head>
            <style></style>
        <style type="text/css">.lf-progress {
  -webkit-appearance: none;
  -moz-apperance: none;
  width: 100%;
  /* margin: 0 10px; */
  height: 4px;
  border-radius: 3px;
  cursor: pointer;
}
.lf-progress:focus {
  outline: none;
  border: none;
}
.lf-progress::-moz-range-track {
  cursor: pointer;
  background: none;
  border: none;
  outline: none;
}
.lf-progress::-webkit-slider-thumb {
  -webkit-appearance: none !important;
  height: 13px;
  width: 13px;
  border: 0;
  border-radius: 50%;
  background: #0fccce;
  cursor: pointer;
}
.lf-progress::-moz-range-thumb {
  -moz-appearance: none !important;
  height: 13px;
  width: 13px;
  border: 0;
  border-radius: 50%;
  background: #0fccce;
  cursor: pointer;
}
.lf-progress::-ms-track {
  width: 100%;
  height: 3px;
  cursor: pointer;
  background: transparent;
  border-color: transparent;
  color: transparent;
}
.lf-progress::-ms-fill-lower {
  background: #ccc;
  border-radius: 3px;
}
.lf-progress::-ms-fill-upper {
  background: #ccc;
  border-radius: 3px;
}
.lf-progress::-ms-thumb {
  border: 0;
  height: 15px;
  width: 15px;
  border-radius: 50%;
  background: #0fccce;
  cursor: pointer;
}
.lf-progress:focus::-ms-fill-lower {
  background: #ccc;
}
.lf-progress:focus::-ms-fill-upper {
  background: #ccc;
}
.lf-player-container :focus {
  outline: 0;
}
.lf-popover {
  position: relative;
}

.lf-popover-content {
  display: inline-block;
  position: absolute;
  opacity: 1;
  visibility: visible;
  transform: translate(0, -10px);
  box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
  transition: all 0.3s cubic-bezier(0.75, -0.02, 0.2, 0.97);
}

.lf-popover-content.hidden {
  opacity: 0;
  visibility: hidden;
  transform: translate(0, 0px);
}

.lf-player-btn-container {
  display: flex;
  align-items: center;
}
.lf-player-btn {
  cursor: pointer;
  fill: #999;
  width: 14px;
}

.lf-player-btn.active {
  fill: #555;
}

.lf-popover {
  position: relative;
}

.lf-popover-content {
  display: inline-block;
  position: absolute;
  background-color: #ffffff;
  opacity: 1;

  transform: translate(0, -10px);
  box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
  transition: all 0.3s cubic-bezier(0.75, -0.02, 0.2, 0.97);
  padding: 10px;
}

.lf-popover-content.hidden {
  opacity: 0;
  visibility: hidden;
  transform: translate(0, 0px);
}

.lf-arrow {
  position: absolute;
  z-index: -1;
  content: '';
  bottom: -9px;
  border-style: solid;
  border-width: 10px 10px 0px 10px;
}

.lf-left-align,
.lf-left-align .lfarrow {
  left: 0;
  right: unset;
}

.lf-right-align,
.lf-right-align .lf-arrow {
  right: 0;
  left: unset;
}

.lf-text-input {
  border: 1px #ccc solid;
  border-radius: 5px;
  padding: 3px;
  width: 60px;
  margin: 0;
}

.lf-color-picker {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  height: 90px;
}

.lf-color-selectors {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.lf-color-component {
  display: flex;
  flex-direction: row;
  font-size: 12px;
  align-items: center;
  justify-content: center;
}

.lf-color-component strong {
  width: 40px;
}

.lf-color-component input[type='range'] {
  margin: 0 0 0 10px;
}

.lf-color-component input[type='number'] {
  width: 50px;
  margin: 0 0 0 10px;
}

.lf-color-preview {
  font-size: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  padding-left: 5px;
}

.lf-preview {
  height: 60px;
  width: 60px;
}

.lf-popover-snapshot {
  width: 150px;
}
.lf-popover-snapshot h5 {
  margin: 5px 0 10px 0;
  font-size: 0.75rem;
}
.lf-popover-snapshot a {
  display: block;
  text-decoration: none;
}
.lf-popover-snapshot a:before {
  content: 'â¥¼';
  margin-right: 5px;
}
.lf-popover-snapshot .lf-note {
  display: block;
  margin-top: 10px;
  color: #999;
}
.lf-player-controls > div {
  margin-right: 5px;
  margin-left: 5px;
}
.lf-player-controls > div:first-child {
  margin-left: 0px;
}
.lf-player-controls > div:last-child {
  margin-right: 0px;
}
</style></head>
        <body data-new-gr-c-s-check-loaded="14.1239.0" data-gr-ext-installed="" data-new-gr-c-s-loaded="14.1239.0">
            


  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive DMAIC Framework Planner - Ashi Tools</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

<style>
* {
  box-sizing: border-box;
}

body {
  font-family: Roboto, sans-serif;
  background: linear-gradient(135deg, #1e293b, #0f172a);
  color: #f3f4f6;
  margin: 0;
  padding: 20px;
  min-height: 100vh;
}

header {
  text-align: center;
  margin-bottom: 30px;
}

h1, h2 {
  color: #3b82f6;
}

.header-controls {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 15px;
  flex-wrap: wrap;
  margin: 20px 0;
}

input, button, select, textarea {
  padding: 12px;
  border: none;
  border-radius: 8px;
  margin: 5px;
  font-size: 16px;
  transition: all 0.3s ease;
  font-family: Roboto, sans-serif;
}

input, textarea, select {
  background: #374151;
  color: #f3f4f6;
  border: 2px solid #4b5563;
}

input:focus, textarea:focus, select:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

button {
  color: #fff;
  background: #3b82f6;
  cursor: pointer;
  font-weight: 500;
  border: 2px solid transparent;
}

button:hover {
  background: #2563eb;
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
}

button:disabled {
  background: #6b7280;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.action-buttons {
  display: flex;
  justify-content: center;
  gap: 10px;
  flex-wrap: wrap;
  margin: 20px 0;
}

.secondary-btn {
  background: #059669;
}

.secondary-btn:hover {
  background: #047857;
}

.danger-btn {
  background: #dc2626;
}

.danger-btn:hover {
  background: #b91c1c;
}

/* Progress Indicator */
.progress-indicator {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 30px 0;
  max-width: 1000px;
  margin-left: auto;
  margin-right: auto;
}

.progress-step {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  flex: 1;
  cursor: pointer;
  transition: all 0.3s ease;
}

.progress-icon {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #374151;
  border: 2px solid #4b5563;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #9ca3af;
  font-size: 1.5rem;
  margin-bottom: 10px;
  transition: all 0.3s ease;
  position: relative;
  z-index: 2;
}

.progress-label {
  font-weight: 500;
  color: #9ca3af;
  font-size: 0.9rem;
  text-align: center;
  transition: all 0.3s ease;
}

.progress-line {
  position: absolute;
  top: 30px;
  left: 60%;
  width: 80%;
  height: 2px;
  background: #4b5563;
  z-index: 1;
}

.progress-step:last-child .progress-line {
  display: none;
}

.progress-step.active .progress-icon {
  background: #3b82f6;
  border-color: #3b82f6;
  color: white;
  transform: scale(1.1);
}

.progress-step.active .progress-label {
  color: #3b82f6;
}

.progress-step.completed .progress-icon {
  background: #059669;
  border-color: #059669;
  color: white;
}

.progress-step.completed .progress-label {
  color: #059669;
}

.progress-step.completed .progress-line {
  background: #059669;
}

/* DMAIC Container */
.dmaic-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 10px;
}

.phase-card {
  background: linear-gradient(145deg, #1f2937, #111827);
  border-radius: 12px;
  margin-bottom: 30px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  border: 1px solid #374151;
  transition: transform 0.3s ease;
}

.phase-card:hover {
  transform: translateY(-2px);
}

.phase-header {
  padding: 20px;
  border-radius: 12px 12px 0 0;
  display: flex;
  align-items: center;
  gap: 15px;
}

.phase-icon {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  color: white;
}

.phase-title {
  font-size: 1.6rem;
  font-weight: 600;
  color: white;
  margin: 0;
}

.phase-description {
  color: rgba(255, 255, 255, 0.8);
  font-size: 1rem;
  margin: 5px 0 0 0;
}

.phase-content {
  padding: 25px;
}

.form-group {
  display: flex;
  flex-direction: column;
  margin-bottom: 20px;
}

.form-group label {
  display: flex;
  align-items: center;
  gap: 8px;
  color: #3b82f6;
  font-weight: 500;
  margin-bottom: 8px;
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-bottom: 20px;
}

textarea {
  min-height: 100px;
  max-height: 200px;
  resize: vertical;
}

.sub-section {
  border-left: 3px solid #3b82f6;
  padding-left: 20px;
  margin: 20px 0;
}

.sub-section-title {
  font-weight: 600;
  color: #3b82f6;
  margin-bottom: 15px;
  font-size: 1.1rem;
}

.list-container {
  margin-bottom: 15px;
}

.list-item {
  display: flex;
  gap: 10px;
  align-items: flex-start;
  margin-bottom: 10px;
}

.item-content {
  flex: 1;
  padding: 12px;
  background: #374151;
  border: 2px solid #4b5563;
  border-radius: 8px;
  color: #f3f4f6;
  min-height: 60px;
  resize: vertical;
}

.item-content:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.remove-btn {
  background: #dc2626;
  color: white;
  border: none;
  border-radius: 50%;
  width: 30px;
  height: 30px;
  cursor: pointer;
  font-size: 0.8rem;
  transition: all 0.3s ease;
}

.remove-btn:hover {
  background: #b91c1c;
  transform: scale(1.1);
}

.add-btn {
  background: #059669;
  color: white;
  border: none;
  border-radius: 8px;
  padding: 10px 15px;
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 5px;
}

.add-btn:hover {
  background: #047857;
}

/* Phase-specific colors */
.define-phase .phase-header { background: #3498db; }
.measure-phase .phase-header { background: #2ecc71; }
.analyze-phase .phase-header { background: #e67e22; }
.improve-phase .phase-header { background: #9b59b6; }
.control-phase .phase-header { background: #e74c3c; }

.define-phase .sub-section { border-left-color: #3498db; }
.define-phase .sub-section-title { color: #3498db; }

.measure-phase .sub-section { border-left-color: #2ecc71; }
.measure-phase .sub-section-title { color: #2ecc71; }

.analyze-phase .sub-section { border-left-color: #e67e22; }
.analyze-phase .sub-section-title { color: #e67e22; }

.improve-phase .sub-section { border-left-color: #9b59b6; }
.improve-phase .sub-section-title { color: #9b59b6; }

.control-phase .sub-section { border-left-color: #e74c3c; }
.control-phase .sub-section-title { color: #e74c3c; }

.template-selector {
  background: #374151;
  color: #f3f4f6;
  border: 2px solid #4b5563;
  width: 100%;
  max-width: 300px;
}

.toast {
  position: fixed;
  top: 20px;
  right: 20px;
  background: #059669;
  color: white;
  padding: 15px 20px;
  border-radius: 8px;
  display: none;
  z-index: 1000;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.8);
}

.modal-content {
  background: #1f2937;
  margin: 5% auto;
  padding: 30px;
  border-radius: 12px;
  width: 90%;
  max-width: 600px;
  color: #f3f4f6;
  position: relative;
}

.close {
  color: #9ca3af;
  float: right;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
  position: absolute;
  right: 20px;
  top: 15px;
}

.close:hover {
  color: #f3f4f6;
}

.auto-save-indicator {
  color: #10b981;
  font-size: 14px;
  opacity: 0;
  transition: opacity 0.3s ease;
  text-align: center;
  margin: 10px 0;
}

.auto-save-indicator.show {
  opacity: 1;
}

footer {
  text-align: center;
  color: #6b7280;
  margin-top: 40px;
  padding: 20px;
  line-height: 1.6;
}

.insta-link {
  color: #e1306c;
  text-decoration: none;
  font-weight: 500;
  transition: all 0.3s ease;
  background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

.insta-link:hover {
  color: #f56565;
  text-shadow: 0 0 8px rgba(225, 48, 108, 0.5);
  transform: scale(1.05);
}

/* Responsive Design */
@media (max-width: 768px) {
  .header-controls {
    flex-direction: column;
  }
  
  .form-row {
    grid-template-columns: 1fr;
  }
  
  .progress-indicator {
    flex-wrap: wrap;
    gap: 15px;
  }
  
  .progress-step {
    flex: 0 0 auto;
    min-width: 80px;
  }
  
  .progress-line {
    display: none;
  }
}

.fade-in {
  animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>



<header>
  <h1><i class="fa-solid fa-project-diagram"></i> Interactive DMAIC Framework Planner</h1>
  <p>Plan and execute your Six Sigma improvement project using the DMAIC methodology</p>
  
  <div class="header-controls">
    <input type="text" id="projectTitle" placeholder="Your Project Title" value="Process Improvement Project">
    <select id="templateSelector" class="template-selector">
      <option value="">Select Template</option>
      <option value="manufacturing">Manufacturing Process</option>
      <option value="service">Service Improvement</option>
      <option value="healthcare">Healthcare Process</option>
      <option value="finance">Financial Process</option>
      <option value="it">IT Process</option>
    </select>
  </div>

  <div class="action-buttons">
    <button onclick="exportPDF()"><i class="fa-solid fa-file-pdf"></i> Export PDF</button>
    <button onclick="saveProject()" class="secondary-btn"><i class="fa-solid fa-save"></i> Save Project</button>
    <button onclick="loadProject()" class="secondary-btn"><i class="fa-solid fa-upload"></i> Load Project</button>
    <button onclick="clearAll()" class="danger-btn"><i class="fa-solid fa-trash"></i> Clear All</button>
  </div>

  <div class="auto-save-indicator" id="autoSaveIndicator">
    <i class="fa-solid fa-check-circle"></i> Auto-saved
  </div>
</header>

<!-- Progress Indicator -->
<div class="progress-indicator">
  <div class="progress-step active" data-phase="define">
    <div class="progress-icon"><i class="fa-solid fa-search"></i></div>
    <div class="progress-label">Define</div>
    <div class="progress-line"></div>
  </div>
  <div class="progress-step" data-phase="measure">
    <div class="progress-icon"><i class="fa-solid fa-chart-bar"></i></div>
    <div class="progress-label">Measure</div>
    <div class="progress-line"></div>
  </div>
  <div class="progress-step" data-phase="analyze">
    <div class="progress-icon"><i class="fa-solid fa-microscope"></i></div>
    <div class="progress-label">Analyze</div>
    <div class="progress-line"></div>
  </div>
  <div class="progress-step" data-phase="improve">
    <div class="progress-icon"><i class="fa-solid fa-tools"></i></div>
    <div class="progress-label">Improve</div>
    <div class="progress-line"></div>
  </div>
  <div class="progress-step" data-phase="control">
    <div class="progress-icon"><i class="fa-solid fa-check-circle"></i></div>
    <div class="progress-label">Control</div>
  </div>
</div>

<div class="dmaic-container">
  <!-- DEFINE PHASE -->
  <div class="phase-card define-phase fade-in" id="define">
    <div class="phase-header">
      <div class="phase-icon"><i class="fa-solid fa-search"></i></div>
      <div>
        <h2 class="phase-title">Define</h2>
        <p class="phase-description">Identify the problem, scope, goals, and customer requirements</p>
      </div>
    </div>
    <div class="phase-content">
      <div class="form-row">
        <div class="form-group">
          <label><i class="fa-solid fa-project-diagram"></i> Project Name</label>
          <input type="text" id="projectName" placeholder="E.g., Call Center Wait Time Reduction" oninput="autoSave()">
        </div>
        <div class="form-group">
          <label><i class="fa-solid fa-user-tie"></i> Project Sponsor</label>
          <input type="text" id="projectSponsor" placeholder="E.g., Jane Smith, VP Operations" oninput="autoSave()">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label><i class="fa-solid fa-calendar-alt"></i> Start Date</label>
          <input type="date" id="startDate" oninput="autoSave()">
        </div>
        <div class="form-group">
          <label><i class="fa-solid fa-calendar-check"></i> Target Completion</label>
          <input type="date" id="targetDate" oninput="autoSave()">
        </div>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-exclamation-triangle"></i> Problem Statement</label>
        <textarea id="problemStatement" placeholder="Clearly articulate the problem, its impact, and its importance. Be specific about what, where, when, and how much..." oninput="autoSave()"></textarea>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-bullseye"></i> Goal Statement</label>
        <textarea id="goalStatement" placeholder="Describe the desired outcome with measurable targets and timeframe..." oninput="autoSave()"></textarea>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-dollar-sign"></i> Business Case</label>
        <textarea id="businessCase" placeholder="Explain the financial or strategic justification for this project..." oninput="autoSave()"></textarea>
      </div>

      <div class="sub-section">
        <div class="sub-section-title">Project Scope</div>
        <div class="form-group">
          <label><i class="fa-solid fa-check-circle"></i> In Scope</label>
          <textarea id="inScope" placeholder="List what is included in the project scope..." oninput="autoSave()"></textarea>
        </div>
        <div class="form-group">
          <label><i class="fa-solid fa-times-circle"></i> Out of Scope</label>
          <textarea id="outScope" placeholder="List what is excluded from the project scope..." oninput="autoSave()"></textarea>
        </div>
      </div>

      <div class="sub-section">
        <div class="sub-section-title">Stakeholders</div>
        <div class="list-container" id="stakeholdersList"><div class="list-item">
      <textarea class="item-content" oninput="autoSave()"></textarea>
      <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
    </div></div>
        <button class="add-btn" onclick="addStakeholder()"><i class="fa-solid fa-plus"></i> Add Stakeholder</button>
      </div>
    </div>
  </div>

  <!-- MEASURE PHASE -->
  <div class="phase-card measure-phase fade-in" id="measure">
    <div class="phase-header">
      <div class="phase-icon"><i class="fa-solid fa-chart-bar"></i></div>
      <div>
        <h2 class="phase-title">Measure</h2>
        <p class="phase-description">Collect baseline data and establish metrics</p>
      </div>
    </div>
    <div class="phase-content">
      <div class="form-group">
        <label><i class="fa-solid fa-sitemap"></i> Process Map</label>
        <textarea id="processMap" placeholder="Describe the detailed process map or flowchart you created..." oninput="autoSave()" data-qb-tmp-id="lt-598940" spellcheck="false" data-gramm="false"></textarea>
      </div>

      <div class="sub-section">
        <div class="sub-section-title">Key Metrics</div>
        <div class="list-container" id="metricsList"><div class="list-item">
      <textarea class="item-content" oninput="autoSave()"></textarea>
      <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
    </div></div>
        <button class="add-btn" onclick="addMetric()"><i class="fa-solid fa-plus"></i> Add Metric</button>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-clipboard-list"></i> Data Collection Plan</label>
        <textarea id="dataCollection" placeholder="Detail how you will collect data: sources, sample size, frequency, responsible persons..." oninput="autoSave()" data-qb-tmp-id="lt-187188" spellcheck="false" data-gramm="false"></textarea>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-chart-line"></i> Baseline Performance</label>
        <textarea id="baselinePerformance" placeholder="Document the current performance levels and variation..." oninput="autoSave()" data-qb-tmp-id="lt-118302" spellcheck="false" data-gramm="false"></textarea>
      </div>
    </div>
  </div>

  <!-- ANALYZE PHASE -->
  <div class="phase-card analyze-phase fade-in" id="analyze">
    <div class="phase-header">
      <div class="phase-icon"><i class="fa-solid fa-microscope"></i></div>
      <div>
        <h2 class="phase-title">Analyze</h2>
        <p class="phase-description">Identify root causes and validate them with data</p>
      </div>
    </div>
    <div class="phase-content">
      <div class="form-group">
        <label><i class="fa-solid fa-search"></i> Process Analysis</label>
        <textarea id="processAnalysis" placeholder="Document your analysis of the process, including value-added and non-value-added steps..." oninput="autoSave()" data-qb-tmp-id="lt-184433" spellcheck="false" data-gramm="false"></textarea>
      </div>

      <div class="sub-section">
        <div class="sub-section-title">Root Causes</div>
        <div class="list-container" id="rootCausesList"><div class="list-item">
      <textarea class="item-content" oninput="autoSave()"></textarea>
      <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
    </div></div>
        <button class="add-btn" onclick="addRootCause()"><i class="fa-solid fa-plus"></i> Add Root Cause</button>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-fish"></i> Fishbone Analysis</label>
        <textarea id="fishboneAnalysis" placeholder="Describe the Ishikawa/Fishbone diagram you created to identify possible causes..." oninput="autoSave()" data-qb-tmp-id="lt-44580" spellcheck="false" data-gramm="false"></textarea>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-chart-bar"></i> Pareto Analysis</label>
        <textarea id="paretoAnalysis" placeholder="Document the Pareto analysis showing the 'vital few' causes..." oninput="autoSave()" data-qb-tmp-id="lt-173601" spellcheck="false" data-gramm="false"></textarea>
      </div>
    </div>
  </div>

  <!-- IMPROVE PHASE -->
  <div class="phase-card improve-phase fade-in" id="improve">
    <div class="phase-header">
      <div class="phase-icon"><i class="fa-solid fa-tools"></i></div>
      <div>
        <h2 class="phase-title">Improve</h2>
        <p class="phase-description">Develop, test, and implement solutions</p>
      </div>
    </div>
    <div class="phase-content">
      <div class="sub-section">
        <div class="sub-section-title">Potential Solutions</div>
        <div class="list-container" id="solutionsList"><div class="list-item">
      <textarea class="item-content" oninput="autoSave()"></textarea>
      <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
    </div></div>
        <button class="add-btn" onclick="addSolution()"><i class="fa-solid fa-plus"></i> Add Solution</button>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-balance-scale"></i> Cost-Benefit Analysis</label>
        <textarea id="costBenefit" placeholder="Document the financial analysis of selected solutions..." oninput="autoSave()" data-qb-tmp-id="lt-330641" spellcheck="false" data-gramm="false"></textarea>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-flask"></i> Pilot Test Results</label>
        <textarea id="pilotResults" placeholder="Describe the pilot implementation and results..." oninput="autoSave()" data-qb-tmp-id="lt-67357" spellcheck="false" data-gramm="false"></textarea>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-tasks"></i> Implementation Plan</label>
        <textarea id="implementationPlan" placeholder="Detail the plan for full implementation: tasks, timeline, resources, responsibilities..." oninput="autoSave()" data-qb-tmp-id="lt-580941" spellcheck="false" data-gramm="false"></textarea>
      </div>
    </div>
  </div>

  <!-- CONTROL PHASE -->
  <div class="phase-card control-phase fade-in" id="control">
    <div class="phase-header">
      <div class="phase-icon"><i class="fa-solid fa-check-circle"></i></div>
      <div>
        <h2 class="phase-title">Control</h2>
        <p class="phase-description">Standardize the solution and monitor ongoing performance</p>
      </div>
    </div>
    <div class="phase-content">
      <div class="form-group">
        <label><i class="fa-solid fa-file-alt"></i> Process Documentation Updates</label>
        <textarea id="processUpdates" placeholder="Describe updates made to process documentation, SOPs, etc..." oninput="autoSave()"></textarea>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-chart-line"></i> Control Charts</label>
        <textarea id="controlCharts" placeholder="Describe the control charts or other statistical process control methods implemented..." oninput="autoSave()" data-qb-tmp-id="lt-644331" spellcheck="false" data-gramm="false"></textarea>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-eye"></i> Monitoring Plan</label>
        <textarea id="monitoringPlan" placeholder="Detail how the process will be monitored going forward: metrics, frequency, responsibilities..." oninput="autoSave()" data-qb-tmp-id="lt-258455" spellcheck="false" data-gramm="false"></textarea>
      </div>

      <div class="form-group">
        <label><i class="fa-solid fa-trophy"></i> Verified Benefits</label>
        <textarea id="verifiedBenefits" placeholder="Document the sustained benefits (financial and non-financial) realized from the improvement..." oninput="autoSave()" data-qb-tmp-id="lt-743160" spellcheck="false" data-gramm="false"></textarea>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label><i class="fa-solid fa-calendar-check"></i> Completion Date</label>
          <input type="date" id="completionDate" oninput="autoSave()">
        </div>
        <div class="form-group">
          <label><i class="fa-solid fa-signature"></i> Project Sign-off</label>
          <input type="text" id="projectSignoff" placeholder="Names of approvers" oninput="autoSave()">
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal for loading projects -->
<div id="loadModal" class="modal" style="display: none;">
  <div class="modal-content">
    <span class="close">Ã</span>
    <h2>Load Saved Project</h2>
    <div id="savedProjects">
      <div style="background: #374151; padding: 15px; margin: 10px 0; border-radius: 8px; cursor: pointer;" onclick="loadSpecificProject(0)">
        <h3>Patient Wait Time Reduction</h3>
        <p>Project: Patient Wait Time Reduction</p>
        <p>Saved: 6/13/2025</p>
        <button onclick="event.stopPropagation(); deleteProject(0)" style="background: #dc2626; margin-top: 10px;">Delete</button>
      </div>
    </div>
  </div>
</div>

<!-- Toast notification -->
<div id="toast" class="toast" style="display: none;">All content cleared!</div>

<footer>
  Built with â¤ï¸ by Ashi | Empowering tomorrow's management leaders<br>
  Connect with me: 
  <a class="insta-link" href="https://www.instagram.com/ashish_singh_rajput_3?utm_source=ig_web_button_share_sheet&amp;igsh=ZDNlZDc0MzIxNw==" target="_blank">
      @ashish_singh_rajput_3
  </a>
</footer>

<script>
// DMAIC Templates
const templates = {
  manufacturing: {
    projectName: "Manufacturing Defect Reduction",
    problemStatement: "Manufacturing line A produces 8% defective units, costing $200K annually in rework and customer returns. Industry standard is 2% defects.",
    goalStatement: "Reduce defect rate from 8% to 3% within 6 months, saving $125K annually.",
    businessCase: "Reducing defects will improve customer satisfaction, reduce warranty costs, and increase manufacturing efficiency by 15%."
  },
  service: {
    projectName: "Customer Service Response Time Improvement",
    problemStatement: "Customer service response time averages 45 minutes, leading to 25% customer dissatisfaction and 15% churn rate.",
    goalStatement: "Reduce average response time to 15 minutes within 4 months, improving customer satisfaction to 90%.",
    businessCase: "Faster response times will reduce churn by 10%, increasing annual revenue by $500K."
  },
  healthcare: {
    projectName: "Patient Wait Time Reduction",
    problemStatement: "Emergency department wait times average 3.5 hours, exceeding national standards and causing patient dissatisfaction.",
    goalStatement: "Reduce average wait time to 2 hours within 6 months while maintaining quality of care.",
    businessCase: "Improved patient flow will increase capacity by 20% and improve patient satisfaction scores."
  },
  finance: {
    projectName: "Invoice Processing Time Reduction",
    problemStatement: "Invoice processing takes 12 days on average, causing cash flow issues and vendor relationship problems.",
    goalStatement: "Reduce invoice processing time to 5 days within 3 months, improving cash flow by $2M.",
    businessCase: "Faster processing will capture early payment discounts worth $150K annually and improve vendor relationships."
  },
  it: {
    projectName: "System Response Time Optimization",
    problemStatement: "Critical business system response time averages 8 seconds, reducing productivity and causing user frustration.",
    goalStatement: "Reduce system response time to 3 seconds within 4 months, improving user productivity by 25%.",
    businessCase: "Improved system performance will save 2 hours per user per week, worth $500K annually in productivity gains."
  }
};

// Initialize the application
document.addEventListener('DOMContentLoaded', function() {
  setupAutoSave();
  loadAutoSave();
  setupEventListeners();
  updateProgressIndicator();
  
  // Set today's date as default
  document.getElementById('startDate').value = new Date().toISOString().split('T')[0];
});

// Setup event listeners
function setupEventListeners() {
  // Template selector
  document.getElementById('templateSelector').addEventListener('change', function() {
    if (this.value) {
      loadTemplate(this.value);
    }
  });

  // Progress indicator
  document.querySelectorAll('.progress-step').forEach(step => {
    step.addEventListener('click', function() {
      const phase = this.getAttribute('data-phase');
      const phaseElement = document.getElementById(phase);
      if (phaseElement) {
        phaseElement.scrollIntoView({ behavior: 'smooth' });
        updateActiveStep(this);
      }
    });
  });

  // Modal controls
  const modal = document.getElementById('loadModal');
  const closeModal = document.querySelector('.close');
  
  closeModal.addEventListener('click', function() {
    modal.style.display = 'none';
  });

  window.addEventListener('click', function(e) {
    if (e.target === modal) {
      modal.style.display = 'none';
    }
  });

  // Sync project title
  document.getElementById('projectTitle').addEventListener('input', function() {
    document.getElementById('projectName').value = this.value;
    autoSave();
  });

  document.getElementById('projectName').addEventListener('input', function() {
    document.getElementById('projectTitle').value = this.value;
    autoSave();
  });
}

// Update active step in progress indicator
function updateActiveStep(activeStep) {
  document.querySelectorAll('.progress-step').forEach(step => {
    step.classList.remove('active');
  });
  activeStep.classList.add('active');
  
  // Mark previous steps as completed
  let markCompleted = true;
  document.querySelectorAll('.progress-step').forEach(step => {
    if (step === activeStep) {
      markCompleted = false;
    }
    if (markCompleted) {
      step.classList.add('completed');
    } else if (step !== activeStep) {
      step.classList.remove('completed');
    }
  });
}

// Update progress indicator based on filled content
function updateProgressIndicator() {
  const phases = ['define', 'measure', 'analyze', 'improve', 'control'];
  
  phases.forEach((phase, index) => {
    const phaseElement = document.getElementById(phase);
    const inputs = phaseElement.querySelectorAll('input, textarea');
    const filledInputs = Array.from(inputs).filter(input => input.value.trim());
    const progressStep = document.querySelector(`[data-phase="${phase}"]`);
    
    if (filledInputs.length > inputs.length * 0.5) {
      progressStep.classList.add('completed');
    } else {
      progressStep.classList.remove('completed');
    }
  });
}

// Load template
function loadTemplate(type) {
  if (templates[type]) {
    if (confirm('This will replace existing content. Continue?')) {
      const template = templates[type];
      document.getElementById('projectTitle').value = template.projectName;
      document.getElementById('projectName').value = template.projectName;
      document.getElementById('problemStatement').value = template.problemStatement;
      document.getElementById('goalStatement').value = template.goalStatement;
      document.getElementById('businessCase').value = template.businessCase;
      
      autoSave();
      updateProgressIndicator();
      showToast(`${type.toUpperCase()} template loaded successfully!`);
    }
  }
}

// Add/Remove item functions
function addStakeholder() {
  const container = document.getElementById('stakeholdersList');
  const newItem = document.createElement('div');
  newItem.className = 'list-item';
  newItem.innerHTML = `
    <textarea class="item-content" placeholder="Enter stakeholder name, role, and impact..." oninput="autoSave()"></textarea>
    <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
  `;
  container.appendChild(newItem);
  newItem.querySelector('textarea').focus();
}

function addMetric() {
  const container = document.getElementById('metricsList');
  const newItem = document.createElement('div');
  newItem.className = 'list-item';
  newItem.innerHTML = `
    <textarea class="item-content" placeholder="Enter metric name, definition, and current value..." oninput="autoSave()"></textarea>
    <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
  `;
  container.appendChild(newItem);
  newItem.querySelector('textarea').focus();
}

function addRootCause() {
  const container = document.getElementById('rootCausesList');
  const newItem = document.createElement('div');
  newItem.className = 'list-item';
  newItem.innerHTML = `
    <textarea class="item-content" placeholder="Describe a potential root cause..." oninput="autoSave()"></textarea>
    <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
  `;
  container.appendChild(newItem);
  newItem.querySelector('textarea').focus();
}

function addSolution() {
  const container = document.getElementById('solutionsList');
  const newItem = document.createElement('div');
  newItem.className = 'list-item';
  newItem.innerHTML = `
    <textarea class="item-content" placeholder="Describe a potential solution..." oninput="autoSave()"></textarea>
    <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
  `;
  container.appendChild(newItem);
  newItem.querySelector('textarea').focus();
}

function removeItem(button) {
  const item = button.closest('.list-item');
  const container = item.parentElement;
  if (container.children.length > 1) {
    item.remove();
    autoSave();
  }
}

// Auto-save functionality
function setupAutoSave() {
  setInterval(() => {
    autoSave();
  }, 30000);
}

function autoSave() {
  const data = {
    projectTitle: document.getElementById('projectTitle').value,
    projectName: document.getElementById('projectName').value,
    projectSponsor: document.getElementById('projectSponsor').value,
    startDate: document.getElementById('startDate').value,
    targetDate: document.getElementById('targetDate').value,
    problemStatement: document.getElementById('problemStatement').value,
    goalStatement: document.getElementById('goalStatement').value,
    businessCase: document.getElementById('businessCase').value,
    inScope: document.getElementById('inScope').value,
    outScope: document.getElementById('outScope').value,
    processMap: document.getElementById('processMap').value,
    dataCollection: document.getElementById('dataCollection').value,
    baselinePerformance: document.getElementById('baselinePerformance').value,
    processAnalysis: document.getElementById('processAnalysis').value,
    fishboneAnalysis: document.getElementById('fishboneAnalysis').value,
    paretoAnalysis: document.getElementById('paretoAnalysis').value,
    costBenefit: document.getElementById('costBenefit').value,
    pilotResults: document.getElementById('pilotResults').value,
    implementationPlan: document.getElementById('implementationPlan').value,
    processUpdates: document.getElementById('processUpdates').value,
    controlCharts: document.getElementById('controlCharts').value,
    monitoringPlan: document.getElementById('monitoringPlan').value,
    verifiedBenefits: document.getElementById('verifiedBenefits').value,
    completionDate: document.getElementById('completionDate').value,
    projectSignoff: document.getElementById('projectSignoff').value,
    stakeholders: getListItems('stakeholdersList'),
    metrics: getListItems('metricsList'),
    rootCauses: getListItems('rootCausesList'),
    solutions: getListItems('solutionsList'),
    timestamp: new Date().toISOString()
  };
  
  localStorage.setItem('dmaic_autosave', JSON.stringify(data));
  
  const indicator = document.getElementById('autoSaveIndicator');
  indicator.classList.add('show');
  setTimeout(() => indicator.classList.remove('show'), 2000);
  
  updateProgressIndicator();
}

function getListItems(containerId) {
  const container = document.getElementById(containerId);
  return Array.from(container.querySelectorAll('.item-content')).map(item => item.value);
}

function setListItems(containerId, items) {
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  
  items.forEach(item => {
    const newItem = document.createElement('div');
    newItem.className = 'list-item';
    newItem.innerHTML = `
      <textarea class="item-content" oninput="autoSave()">${item}</textarea>
      <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
    `;
    container.appendChild(newItem);
  });
  
  // Ensure at least one item
  if (items.length === 0) {
    const newItem = document.createElement('div');
    newItem.className = 'list-item';
    newItem.innerHTML = `
      <textarea class="item-content" placeholder="Enter information..." oninput="autoSave()"></textarea>
      <button class="remove-btn" onclick="removeItem(this)"><i class="fa-solid fa-times"></i></button>
    `;
    container.appendChild(newItem);
  }
}

function loadAutoSave() {
  const saved = localStorage.getItem('dmaic_autosave');
  if (saved) {
    const data = JSON.parse(saved);
    
    // Load all field values
    Object.keys(data).forEach(key => {
      const element = document.getElementById(key);
      if (element && data[key] !== undefined) {
        element.value = data[key];
      }
    });
    
    // Load list items
    if (data.stakeholders) setListItems('stakeholdersList', data.stakeholders);
    if (data.metrics) setListItems('metricsList', data.metrics);
    if (data.rootCauses) setListItems('rootCausesList', data.rootCauses);
    if (data.solutions) setListItems('solutionsList', data.solutions);
    
    updateProgressIndicator();
  }
}

// Save project functionality
function saveProject() {
  const title = document.getElementById('projectTitle').value || 'Untitled DMAIC Project';
  const data = {
    title: title,
    projectName: document.getElementById('projectName').value,
    projectSponsor: document.getElementById('projectSponsor').value,
    startDate: document.getElementById('startDate').value,
    targetDate: document.getElementById('targetDate').value,
    problemStatement: document.getElementById('problemStatement').value,
    goalStatement: document.getElementById('goalStatement').value,
    businessCase: document.getElementById('businessCase').value,
    inScope: document.getElementById('inScope').value,
    outScope: document.getElementById('outScope').value,
    processMap: document.getElementById('processMap').value,
    dataCollection: document.getElementById('dataCollection').value,
    baselinePerformance: document.getElementById('baselinePerformance').value,
    processAnalysis: document.getElementById('processAnalysis').value,
    fishboneAnalysis: document.getElementById('fishboneAnalysis').value,
    paretoAnalysis: document.getElementById('paretoAnalysis').value,
    costBenefit: document.getElementById('costBenefit').value,
    pilotResults: document.getElementById('pilotResults').value,
    implementationPlan: document.getElementById('implementationPlan').value,
    processUpdates: document.getElementById('processUpdates').value,
    controlCharts: document.getElementById('controlCharts').value,
    monitoringPlan: document.getElementById('monitoringPlan').value,
    verifiedBenefits: document.getElementById('verifiedBenefits').value,
    completionDate: document.getElementById('completionDate').value,
    projectSignoff: document.getElementById('projectSignoff').value,
    stakeholders: getListItems('stakeholdersList'),
    metrics: getListItems('metricsList'),
    rootCauses: getListItems('rootCausesList'),
    solutions: getListItems('solutionsList'),
    timestamp: new Date().toISOString()
  };
  
  const projects = JSON.parse(localStorage.getItem('saved_dmaic_projects') || '[]');
  projects.push(data);
  localStorage.setItem('saved_dmaic_projects', JSON.stringify(projects));
  
  showToast('DMAIC project saved successfully!');
}

// Load project functionality
function loadProject() {
  const projects = JSON.parse(localStorage.getItem('saved_dmaic_projects') || '[]');
  const modal = document.getElementById('loadModal');
  const container = document.getElementById('savedProjects');
  
  if (projects.length === 0) {
    container.innerHTML = '<p>No saved DMAIC projects found.</p>';
  } else {
    container.innerHTML = projects.map((project, index) => `
      <div style="background: #374151; padding: 15px; margin: 10px 0; border-radius: 8px; cursor: pointer;" onclick="loadSpecificProject(${index})">
        <h3>${project.title}</h3>
        <p>Project: ${project.projectName || 'Not specified'}</p>
        <p>Saved: ${new Date(project.timestamp).toLocaleDateString()}</p>
        <button onclick="event.stopPropagation(); deleteProject(${index})" style="background: #dc2626; margin-top: 10px;">Delete</button>
      </div>
    `).join('');
  }
  
  modal.style.display = 'block';
}

function loadSpecificProject(index) {
  const projects = JSON.parse(localStorage.getItem('saved_dmaic_projects') || '[]');
  const project = projects[index];
  
  if (project) {
    Object.keys(project).forEach(key => {
      const element = document.getElementById(key);
      if (element && project[key] !== undefined) {
        element.value = project[key];
      }
    });
    
    // Load list items
    if (project.stakeholders) setListItems('stakeholdersList', project.stakeholders);
    if (project.metrics) setListItems('metricsList', project.metrics);
    if (project.rootCauses) setListItems('rootCausesList', project.rootCauses);
    if (project.solutions) setListItems('solutionsList', project.solutions);
    
    document.getElementById('loadModal').style.display = 'none';
    updateProgressIndicator();
    showToast('DMAIC project loaded successfully!');
  }
}

function deleteProject(index) {
  if (confirm('Are you sure you want to delete this project?')) {
    const projects = JSON.parse(localStorage.getItem('saved_dmaic_projects') || '[]');
    projects.splice(index, 1);
    localStorage.setItem('saved_dmaic_projects', JSON.stringify(projects));
    loadProject();
    showToast('Project deleted successfully!');
  }
}

// Clear all functionality
function clearAll() {
  if (confirm('Are you sure you want to clear all content? This cannot be undone.')) {
    document.querySelectorAll('input, textarea').forEach(element => {
      element.value = '';
    });
    
    // Reset list items
    setListItems('stakeholdersList', ['']);
    setListItems('metricsList', ['']);
    setListItems('rootCausesList', ['']);
    setListItems('solutionsList', ['']);
    
    document.getElementById('projectTitle').value = 'Process Improvement Project';
    document.getElementById('startDate').value = new Date().toISOString().split('T')[0];
    
    autoSave();
    updateProgressIndicator();
    showToast('All content cleared!');
  }
}

// Toast notification
function showToast(message) {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.style.display = 'block';
  setTimeout(() => {
    toast.style.display = 'none';
  }, 3000);
}

// Enhanced PDF Export
function exportPDF() {
  const title = document.getElementById('projectTitle').value || 'DMAIC Project';
  
  if (!document.getElementById('problemStatement').value.trim()) {
    showToast('Please fill in the problem statement before exporting.');
    return;
  }

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  let y = 20;
  
  // Title page
  doc.setFontSize(24);
  doc.setTextColor('#3498db');
  doc.text('DMAIC Framework Project', 20, y);
  y += 20;
  
  doc.setFontSize(18);
  doc.setTextColor('#111827');
  doc.text(title, 20, y);
  y += 15;
  
  doc.setFontSize(12);
  doc.setTextColor('#6b7280');
  doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 20, y);
  y += 30;

  // Define Phase
  if (y > 250) { doc.addPage(); y = 20; }
  doc.setFontSize(16);
  doc.setTextColor('#3498db');
  doc.text('DEFINE PHASE', 20, y);
  y += 15;
  
  const defineFields = [
    { label: 'Project Name', value: document.getElementById('projectName').value },
    { label: 'Project Sponsor', value: document.getElementById('projectSponsor').value },
    { label: 'Problem Statement', value: document.getElementById('problemStatement').value },
    { label: 'Goal Statement', value: document.getElementById('goalStatement').value },
    { label: 'Business Case', value: document.getElementById('businessCase').value }
  ];
  
  defineFields.forEach(field => {
    if (field.value.trim()) {
      if (y > 250) { doc.addPage(); y = 20; }
      doc.setFontSize(12);
      doc.setTextColor('#111827');
      doc.text(field.label + ':', 20, y);
      y += 8;
      
      const splitText = doc.splitTextToSize(field.value.trim(), 170);
      doc.text(splitText, 20, y);
      y += splitText.length * 5 + 10;
    }
  });

  // Measure Phase
  if (y > 230) { doc.addPage(); y = 20; }
  doc.setFontSize(16);
  doc.setTextColor('#2ecc71');
  doc.text('MEASURE PHASE', 20, y);
  y += 15;
  
  const measureFields = [
    { label: 'Process Map', value: document.getElementById('processMap').value },
    { label: 'Data Collection Plan', value: document.getElementById('dataCollection').value },
    { label: 'Baseline Performance', value: document.getElementById('baselinePerformance').value }
  ];
  
  measureFields.forEach(field => {
    if (field.value.trim()) {
      if (y > 250) { doc.addPage(); y = 20; }
      doc.setFontSize(12);
      doc.setTextColor('#111827');
      doc.text(field.label + ':', 20, y);
      y += 8;
      
      const splitText = doc.splitTextToSize(field.value.trim(), 170);
      doc.text(splitText, 20, y);
      y += splitText.length * 5 + 10;
    }
  });

  // Analyze Phase
  if (y > 230) { doc.addPage(); y = 20; }
  doc.setFontSize(16);
  doc.setTextColor('#e67e22');
  doc.text('ANALYZE PHASE', 20, y);
  y += 15;
  
  const analyzeFields = [
    { label: 'Process Analysis', value: document.getElementById('processAnalysis').value },
    { label: 'Fishbone Analysis', value: document.getElementById('fishboneAnalysis').value },
    { label: 'Pareto Analysis', value: document.getElementById('paretoAnalysis').value }
  ];
  
  analyzeFields.forEach(field => {
    if (field.value.trim()) {
      if (y > 250) { doc.addPage(); y = 20; }
      doc.setFontSize(12);
      doc.setTextColor('#111827');
      doc.text(field.label + ':', 20, y);
      y += 8;
      
      const splitText = doc.splitTextToSize(field.value.trim(), 170);
      doc.text(splitText, 20, y);
      y += splitText.length * 5 + 10;
    }
  });

  // Improve Phase
  if (y > 230) { doc.addPage(); y = 20; }
  doc.setFontSize(16);
  doc.setTextColor('#9b59b6');
  doc.text('IMPROVE PHASE', 20, y);
  y += 15;
  
  const improveFields = [
    { label: 'Cost-Benefit Analysis', value: document.getElementById('costBenefit').value },
    { label: 'Pilot Test Results', value: document.getElementById('pilotResults').value },
    { label: 'Implementation Plan', value: document.getElementById('implementationPlan').value }
  ];
  
  improveFields.forEach(field => {
    if (field.value.trim()) {
      if (y > 250) { doc.addPage(); y = 20; }
      doc.setFontSize(12);
      doc.setTextColor('#111827');
      doc.text(field.label + ':', 20, y);
      y += 8;
      
      const splitText = doc.splitTextToSize(field.value.trim(), 170);
      doc.text(splitText, 20, y);
      y += splitText.length * 5 + 10;
    }
  });

  // Control Phase
  if (y > 230) { doc.addPage(); y = 20; }
  doc.setFontSize(16);
  doc.setTextColor('#e74c3c');
  doc.text('CONTROL PHASE', 20, y);
  y += 15;
  
  const controlFields = [
    { label: 'Process Documentation Updates', value: document.getElementById('processUpdates').value },
    { label: 'Control Charts', value: document.getElementById('controlCharts').value },
    { label: 'Monitoring Plan', value: document.getElementById('monitoringPlan').value },
    { label: 'Verified Benefits', value: document.getElementById('verifiedBenefits').value }
  ];
  
  controlFields.forEach(field => {
    if (field.value.trim()) {
      if (y > 250) { doc.addPage(); y = 20; }
      doc.setFontSize(12);
      doc.setTextColor('#111827');
      doc.text(field.label + ':', 20, y);
      y += 8;
      
      const splitText = doc.splitTextToSize(field.value.trim(), 170);
      doc.text(splitText, 20, y);
      y += splitText.length * 5 + 10;
    }
  });

  // Footer on all pages
  const pageCount = doc.internal.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFontSize(10);
    doc.setTextColor('#9ca3af');
    doc.text(`Page ${i} of ${pageCount} | Generated by Ashi Tools`, 20, 290);
  }

  doc.save(`${title.replace(/[^a-z0-9]/gi, '_')}_DMAIC.pdf`);
  showToast('PDF exported successfully!');
}
</script>



            <script></script>
        
    
<qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 2106px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 2385px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 2610px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 2889px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 3255px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 3417px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 3921px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 4137px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 4295px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 4587px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 4787px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 4944px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar><qb-toolbar contenteditable="false" id="qb-toolbar-container" style="display: none;"><qb-div class="qb-toolbar__wrapper qb-toolbar__wrapper--hide" style="left: 1211px; position: absolute !important; top: 5102px !important; bottom: auto !important; z-index: auto; opacity: 1 !important; pointer-events: all !important;"><div style="all: initial !important;"><qb-div style="all: initial !important;"></qb-div></div></qb-div></qb-toolbar></body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration>